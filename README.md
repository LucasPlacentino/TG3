# (TG)³ - TooGoodToGo Telegram Notifications
A fork of [LauPaSat-pl/TGTG notifications](https://github.com/LauPaSat-pl/TGTG_notifications), and inspired by [Der-Henning/tgtg](https://github.com/Der-Henning/tgtg) and [kacpi2442/am_bot](https://github.com/kacpi2442/am_bot/tree/main)

[![GitHub Repo stars](https://img.shields.io/github/stars/LucasPlacentino/TG3?style=plastic&logo=data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KDTwhLS0gVXBsb2FkZWQgdG86IFNWRyBSZXBvLCB3d3cuc3ZncmVwby5jb20sIFRyYW5zZm9ybWVkIGJ5OiBTVkcgUmVwbyBNaXhlciBUb29scyAtLT4KPHN2ZyBmaWxsPSIjZmZmZmZmIiB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSIyNTZweCIgaGVpZ2h0PSIyNTZweCIgdmlld0JveD0iLTIuNTMgLTIuNTMgNDEuMTUgNDEuMTUiIHhtbDpzcGFjZT0icHJlc2VydmUiIHN0cm9rZT0iI2ZmZmZmZiI+Cg08ZyBpZD0iU1ZHUmVwb19iZ0NhcnJpZXIiIHN0cm9rZS13aWR0aD0iMCIvPgoNPGcgaWQ9IlNWR1JlcG9fdHJhY2VyQ2FycmllciIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+Cg08ZyBpZD0iU1ZHUmVwb19pY29uQ2FycmllciI+IDxnPiA8cGF0aCBkPSJNMzYuMDQyLDEzLjkwOWMtMC4xMjMtMC4zNzctMC40NTYtMC42NDYtMC44NS0wLjY4OGwtMTEuNTQ5LTEuMTcyTDE4Ljk2LDEuNDNjLTAuMTYtMC4zNi0wLjUxOS0wLjU5Ni0wLjkxNS0wLjU5NiBzLTAuNzU1LDAuMjM0LTAuOTE1LDAuNTk4TDEyLjQ0NiwxMi4wNUwwLjg5OSwxMy4yMjFjLTAuMzk0LDAuMDQtMC43MjgsMC4zMTItMC44NSwwLjY4OGMtMC4xMjMsMC4zNzctMC4wMTEsMC43OTEsMC4yODUsMS4wNTUgbDguNjUyLDcuNzM4TDYuNTMzLDM0LjA0NWMtMC4wODMsMC4zODcsMC4wNjksMC43ODcsMC4zOSwxLjAyYzAuMTc1LDAuMTI3LDAuMzgxLDAuMTkxLDAuNTg4LDAuMTkxIGMwLjE3MywwLDAuMzQ3LTAuMDQ1LDAuNTAzLTAuMTM3bDEwLjAzMi01Ljg0bDEwLjAzLDUuODRjMC4zNDIsMC4xOTcsMC43NywwLjE3OCwxLjA5MS0wLjA1OWMwLjMyLTAuMjI5LDAuNDc0LTAuNjMzLDAuMzkxLTEuMDIgbC0yLjQ1My0xMS4zNDRsOC42NTMtNy43MzdDMzYuMDUyLDE0LjY5OSwzNi4xNjUsMTQuMjg1LDM2LjA0MiwxMy45MDl6IE0yNS4zMzYsMjEuNTk4Yy0wLjI2OCwwLjI0LTAuMzg3LDAuNjA1LTAuMzExLDAuOTU3IGwyLjA5Nyw5LjY5NWwtOC41NzQtNC45OWMtMC4zMTEtMC4xODItMC42OTUtMC4xODItMS4wMDYsMGwtOC41NzYsNC45OWwyLjA5Ny05LjY5NWMwLjA3Ni0wLjM1Mi0wLjA0My0wLjcxNy0wLjMxMS0wLjk1NyBsLTcuMzk2LTYuNjEzbDkuODctMS4wMDJjMC4zNTgtMC4wMzUsMC42NjgtMC4yNjQsMC44MTQtMC41OTJsNC4wMDQtOS4wNzdsNC4wMDMsOS4wNzdjMC4xNDYsMC4zMjgsMC40NTYsMC41NTcsMC44MTQsMC41OTIgbDkuODcsMS4wMDJMMjUuMzM2LDIxLjU5OHoiLz4gPC9nPiA8L2c+Cg08L3N2Zz4=&label=Star&logoSize=auto&color=gold&labelColor=%23424c52)](https://github.com/LucasPlacentino/TG3) 
[![tgtg notifications](../../actions/workflows/notitications.yml/badge.svg)](../../actions/workflows/notitications.yml)
[![tgtg notifications](../../actions/workflows/notitications2.yml/badge.svg)](../../actions/workflows/notitications2.yml)
[![tgtg notifications](../../actions/workflows/notitications3.yml/badge.svg)](../../actions/workflows/notitications3.yml)

## There are 2 versions: 

||1. Github Actions |2. Self-hosted |
|:---|:---:|:---:|
|**Status**|🟩 Fully working|🟨 WIP|
|**Runs on**|Github servers|_Your_ server|
|**_- Features:_**|----------|----------|
|Easy setup|✅|🟨[^1]|
|Notifies available items|✅|✅|
|Shows price of items|✅|✅|
|Shows quantity available|✅|✅|
|Shows store location|✅|✅|
|Shows description|✅|✅|
|Link to open app|✅|✅|
|Prevents repetition[^2]|❌|✅|
|...[^3]|❌|✅|

[^1]: _Not difficult if you know how to run a simple linux server._
[^2]: _Prevents sending notifications for available items that were already sent._
[^3]: TODO._

## Setup:
1. Create a new Telegram bot using BotFather [tutorial](https://core.telegram.org/bots#how-do-i-create-a-bot) -> get your `TG_BOT_ID`,  
2. Check your Telegram ID [tutorial](https://www.alphr.com/telegram-find-user-id/) -> this will be your `TG_CHAT_ID`,  
3. Install the [`tgtg`](https://github.com/ahivert/tgtg-python) Python library  
```
pip install tgtg
```
4. Run with `python`  
```python
from tgtg import TgtgClient

client = TgtgClient(email="your_email@example.org")
credentials = client.get_credentials()
```
You should receive an **email** from TooGoodToGo. The client will wait until you validate the login by **clicking the link inside the email**.  

Once you clicked the link, you will get **credentials** and be able to see them with:  
```python
print(credentials)
```

They will look like this:  
```python
{
    'access_token': '<your_access_token>',
    'refresh_token': '<your_refresh_token>',
    'user_id': '<your_user_id>',
    'cookie': '<cookie>',
}
```
These will be your TGTG `ACCESS_TOKEN`, `REFRESH_TOKEN`, `TGTG_USER_ID`, and `COOKIE`.

## 1. Github Actions workflows
**This runs 100% automatically on Github Actions** (not counting the set up), to check for your favourite available TooGoodToGo items and send you a Telegram message about it. You can make it run periodically, for example every 15 minutes.

### Steps:
1. Fork this repo,  
2. **In your repo** add **secrets** ([tutorial](https://docs.github.com/en/actions/security-guides/using-secrets-in-github-actions#creating-secrets-for-a-repository)) you got from earlier steps (TooGoodToGo and Telegram), you can check how to name them in [`notitications.yml`](./.github/workflows/notifications.yml) file,  
    **[DO NOT PUT THEM VISIBLE IN `.py` or `.yml` FILES DIRECTLY OR ELSE YOU WILL HAVE TO REVOKE YOUR CREDENTIALS AND DELETE YOUR FORK]**  
3. _[Optional]_ Change the schedule in the [`.github/workflows/notifications.yml`](./.github/workflows/notifications.yml) file,
4. Make sure it's up and running. Done!  

## 2. Self-hosted app

_**[WIP]**_  
> TODO  

### Steps:

> TODO  
> clone  
> .env.template -> .env  
> docker?  
> ...  
